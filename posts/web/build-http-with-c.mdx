---
title: C로 HTTP 서버 만들기
description: C로 HTTP의 원리를 이해하며 HTTP 서버를 만듭니다.
cover:
tags: web, c, http, server
date: 2025-05-07 16:53:00
author: yeahx4
series:
seriesIndex:
coverTitle: HTTP Server
coverSub: with C
coverTs: 90
coverBg: E5BE01
coverColor: ffffff
---

맨날 HTTP 프로그래밍을 할 때 이미 만들어진 라이브러리 위에서 작업을 해 왔습니다.
그저 "딸깍" 한번이면 HTTP 서버가 뚝딱 만들어지고 멀티스레딩, 여러 처리 등을
완벽하게 수행해주는 라이브러리가 널렸습니다. 현대 언어에서는 HTTP 관련 라이브러리가
내장되어 있기도 합니다. 그래서 더더욱 HTTP가 어떻게 동작하는지 잘 모르고 있었습니다.
이번 포스트에서는 C로 내장 라이브러리만 사용하여 HTTP 서버를 만들어 보겠습니다.
C로 low-level 프로그래밍을 하면서 HTTP의 원리를 살펴봅시다.

# OSI 7 Layer

OSI 7 계층은 컴퓨터 네트워크의 통신 프로토콜을 7개의 계층으로 나눈 것입니다.
네트워크 통신은 복잡한 프로세스를 통해 이루어집니다. 각 계층을 나눠 설계함으로써
각 계층의 독립성을 높이고 유지보수를 용이하게 합니다.

![OSI 7 Layer](/img/web/c-http/osi.png)

HTTP는 OSI 7 계층 중 7번째인 애플리케이션 계층에 해당합니다.
HTTP는 TCP/IP 프로토콜을 기반으로 데이터를 전송합니다.
TCP/IP는 OSI 7 계층 중 4번째인 전송 계층에 해당합니다.
저희는 HTTP 서버를 만들기 위해 TCP/IP 소켓 프로그래밍을 사용할 예정입니다.
즉, TCP가 어떻게 작동하는지 등은 저희가 고려할 부분이 아닙니다. 이것이 계층화의 장점입니다.
사용자는 그저 데이터가 전송된다는 사실만 알면 되지 어떤 방식으로 전송되는지,
3-way handshake가 어떻게 이루어지는지, 패킷이 어떻게 전송되는지 알 필요가 없습니다.

# HTTP의 구조

HTTP는 Hyper **Text** Transfer Protocol의 약자입니다. 이름에서 알 수 있듯이
텍스트를 전송하는 프로토콜입니다. HTTP는 클라이언트가 서버에 요청을 보내고 서버가 다시
클라이언트에게 응답을 보내는 방식으로 동작합니다. 이 과정에서 텍스트로 데이터를 주고받습니다.

![HTTP message](/img/web/c-http/req-res.png)

이 텍스트는 위 그림처럼 생겼습니다. 이 텍스트를 HTTP message라고 부릅니다.
HTTP 메시지는 크게 요청(request)과 응답(response)로 나뉘지만 형태가 거의 똑같습니다.
각 메세지는 크게 세 부분으로 이루어져 있습니다. HTTP 메소드와 URL, 버전을 알려주는
start line과 헤더(header), 그리고 실제 데이터인 body입니다. 지금 보고 있는 페이지도
제 블로그 서버에 GET 요청을 보내고 서버가 HTML을 응답으로 보내준 결과입니다.

HTTP 서버/클라이언트를 만든다는 것은 저 메시지를 주고받는 프로그램을 만드는 것입니다.
HTTP 메시지를 적절하게 생성해 전송하고, 수신한 메시지를 적절하게 파싱해 처리하는 것이
HTTP 애플리케이션의 전부입니다. 저 메시지 자체가 TCP 계층에서 어떻게 전송되는지는
관심이 없고 HTTP 메시지를 수신/전송하는 것이 저희의 목표입니다.
